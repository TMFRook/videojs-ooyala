videojs.Ooyala=videojs.MediaTechController.extend({init:function(player,options,ready){videojs.MediaTechController.call(this,player,options,ready);if(typeof options["source"]!="undefined"){for(var key in options["source"]){player.options()[key]=options["source"][key]}}this.player_=player;this.player_el_=document.getElementById(player.id());this.player_el_.className+=" vjs-ooyala";var self=this;this.id_=this.player_.id()+"_ooyala_api";this.el_=videojs.Component.prototype.createEl("iframe",{id:this.id_,className:"vjs-tech",scrolling:"no",marginWidth:0,marginHeight:0,frameBorder:0,webkitAllowFullScreen:"true",mozallowfullscreen:"true",allowFullScreen:"true"});this.iframeblocker=videojs.Component.prototype.createEl("div",{className:"iframeblocker"});var self=this;var toggleThis=function(){if(self.paused()){self.play()}else{self.pause()}};if(this.iframeblocker.addEventListener){this.iframeblocker.addEventListener("click",toggleThis)}else{this.iframeblocker.attachEvent("onclick",toggleThis)}this.player_el_.insertBefore(this.iframeblocker,this.player_el_.firstChild);this.player_el_.insertBefore(this.el_,this.iframeblocker);this.contentId=player.options()["contentId"];if(videojs.Ooyala.apiReady){videojs.Ooyala.loadOoyala(this.player_el_.id,this.videoId)}else{function loadExtScript(src,test,callback){var tag=document.createElement("script");tag.src=src;var firstScriptTag=document.getElementsByTagName("script")[0];firstScriptTag.parentNode.insertBefore(tag,firstScriptTag);var callbackTimer=setInterval(function(){var call=false;try{call=test.call()}catch(e){}if(call){clearInterval(callbackTimer);callback.call()}},100)}var playerId=player.options()["playerId"];var src="//player.ooyala.com/v3/"+playerId+"?platform=html5-priority";if(window.location.protocol=="file:"){src="http:"+src}loadExtScript(src,function(){return OO},function(){videojs.Ooyala.loadOoyala(this.player_el_.id,this.contentId)}.bind(this))}}});videojs.Ooyala.prototype.dispose=function(){videojs.MediaTechController.prototype.dispose.call(this)};videojs.Ooyala.prototype.load=function(){};videojs.Ooyala.prototype.play=function(){};videojs.Ooyala.prototype.pause=function(){};videojs.Ooyala.prototype.paused=function(){};videojs.Ooyala.prototype.currentTime=function(){};videojs.Ooyala.prototype.setCurrentTime=function(seconds){};videojs.Ooyala.prototype.duration=function(){};videojs.Ooyala.prototype.volume=function(){};videojs.Ooyala.prototype.setVolume=function(percentAsDecimal){};videojs.Ooyala.prototype.muted=function(){};videojs.Ooyala.prototype.setMuted=function(muted){};videojs.Ooyala.prototype.buffered=function(){};videojs.Ooyala.prototype.supportsFullScreen=function(){return true};videojs.Ooyala.isSupported=function(){return true};videojs.Ooyala.canPlaySource=function(srcObj){return srcObj.type=="video/ooyala"};videojs.Ooyala.canControlVolume=function(){return true};videojs.Ooyala.loadOoyala=function(player,videoId){this.ooPlayer={};OO.ready(function(){this.ooPlayer=OO.Player.create(player,videoId,{onCreate:function(player){player.subscribe("*","vjs-ooyala",function(eventName){});player.subscribe("error","vjs-ooyala",function(eventName,payload){console.log(eventName+": "+payload)});player.subscribe("playbackReady","vjs-ooyala",function(eventName){this.apiReady=true})},autoplay:true,wmode:"opaque"})})};videojs.Ooyala.prototype.onError=function(error){this.player_.error=error;this.player_.trigger("error")};